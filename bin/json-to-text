#!/usr/bin/perl
# vim: ts=2 sw=2 ft=perl
eval 'exec perl -x -wS $0 ${1+"$@"}'
  if 0;
BEGIN { $DB::single=1; }
$|++;
use lib "lib";
use autodie;
use common::sense;
use JSON::MaybeXS();
use Nobody::PP;
use Nobody::Util;
use OpenAI::API;
use Text::Wrap;

our(@VERSION) = qw( 0 1 0 );
sub encode_json {
  JSON::MaybeXS->new({pretty=>1, utf8=>1})->encode(@_);;
};
sub decode_json {
  JSON::MaybeXS->new({pretty=>1, utf8=>1})->decode(@_);;
};
@ARGV=qw( conv/current.json ) unless @ARGV;
for my $file(@ARGV) {
  my ($json)=path($file)->slurp;
  my ($pobj)=decode_json($json);
  for(@{$pobj}) {
    my ($role)=$_->{role};
    say " | --------";
    say " |";
    say " | role: $role";
    say " |";
    say " | $_" for split(m{\n},fill("","",$_->{content}));
    say " |";
  };
};
